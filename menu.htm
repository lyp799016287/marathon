<header>
	<nav class="navbar navbar-inverse navbar-fixed-top">
		<div class="container">
			<div class="navbar-header">
				<button aria-controls="navbar" aria-expanded="false" data-target="#navbar" data-toggle="collapse" class="navbar-toggle collapsed" type="button">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a href="javascript:void(0);" class="navbar-brand">医道后台管理系统</a>
			</div>
			<div class="navbar-collapse collapse" id="navbar">
				<ul class="nav navbar-nav" id="menu_list"></ul>
				<ul class="nav navbar-nav navbar-right" id="menu-right">
					<li>
						<a href="javascript:void(0);" id="userName"></a>
					</li>
				</ul>
			</div>
			<!--/.nav-collapse -->
		</div>
	</nav>
</header>

<script type="text/javascript">
	var menu = {};
	menu.init = function(){		
		$.ajax({
			type : 'POST',
			url : '/login/login/getmenu/',
			dataType : 'json',
			success: function(rdata) {
				if(rdata.code == 1){
					menu.makeMenu(rdata.data);
				}
			},
			error: function() {
				alert("接口调用失败");
			}
		});
	}

	menu.makeMenu = function(data){
		var hml = '';
		for(var i=0; i< data.length; i++){
			hml += '<li class="dropdown"><a aria-expanded="false" aria-haspopup="true" role="button" data-toggle="dropdown" class="dropdown-toggle" href="javascript:void(0);"><span aria-hidden="true" class="glyphicon '+data[i]['icon']+'"></span>'+data[i]['name'];
			var menu_arr = data[i]['menu'];
			if(menu_arr.length !=0){
				hml += '<span class="caret"></span>';
				hml += '</a><ul class="dropdown-menu">';

				for(var j=0; j < menu_arr.length; j++){
					hml += '<li><a href="'+menu_arr[j]['url']+'">'+menu_arr[j]['name']+'</a></li>';
				}
				hml += '</ul>';
			}	
			hml += '</li>';

		}
		$("#menu_list").empty().html(hml);

		/*$(".dropdown-toggle").click(function(){
			$(this).parent("li").addClass('open');
		});*/
		$(".dropdown-toggle").hover(function(){
			$(this).parent("li").addClass('open');
		}, function(){
			$(this).parent("li").removeClass('open');
		});

		$(".dropdown-menu").hover(function(){
			$(this).parent("li").addClass('open');
		}, function(){
			$(this).parent("li").removeClass('open');
		})
	}

	menu.init();
</script>